@inject IAboutService _aboutService;
@inject ISettingService _settingService;
@using CaoGiaConstruction.Utilities
@{
    Layout = null;
    var about = await _aboutService.GetAboutCacheAsync();
    var setting = await _settingService.GetSettingCacheAsync();
    var logoUrl = !string.IsNullOrEmpty(about?.LogoTop) 
        ? about.LogoTop.ToHostImage() 
        : Url.Content("~/Admin/assets/images/logo.png");
    var primaryColor = setting?.PrimaryColor ?? "#007bff";
    
    // Convert hex to RGB for CSS variables
    string primaryRgb = "0, 123, 255"; // Default blue
    if (!string.IsNullOrEmpty(primaryColor) && primaryColor.StartsWith("#"))
    {
        try
        {
            var hex = primaryColor.TrimStart('#');
            if (hex.Length == 6)
            {
                var r = Convert.ToInt32(hex.Substring(0, 2), 16);
                var g = Convert.ToInt32(hex.Substring(2, 2), 16);
                var b = Convert.ToInt32(hex.Substring(4, 2), 16);
                primaryRgb = $"{r}, {g}, {b}";
            }
        }
        catch
        {
            // Keep default if conversion fails
        }
    }
}

<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <title>ĐĂNG NHẬP - CAO GIA CONSTRUCTION</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta content="Hệ thống quản lý website Cao Gia Construction" name="description" />
    <meta content="Cung cấp bởi HQSolutions" name="author" />

    <!-- App favicon -->
    <link rel="shortcut icon" href="~/favicon.ico">

    <!-- Theme Config Js -->
    <script src="~/Admin/assets/js/hyper-config.js"></script>

    <!-- App css -->
    <link href="~/Admin/assets/css/app-saas.min.css" rel="stylesheet" type="text/css" id="app-style" />

    <!-- Icons css -->
    <link href="~/Admin/assets/css/icons.min.css" rel="stylesheet" type="text/css" />

    <!-- Dynamic Primary Color from Setting -->
    <style>
        :root {
            --ct-primary: @primaryColor !important;
            --ct-primary-rgb: @primaryRgb !important;
        }
        .bg-primary {
            background-color: @primaryColor !important;
        }
        .text-primary {
            color: @primaryColor !important;
        }
        .btn-primary {
            background-color: @primaryColor !important;
            border-color: @primaryColor !important;
        }
        .btn-primary:hover {
            background-color: @primaryColor !important;
            border-color: @primaryColor !important;
            opacity: 0.9;
        }
        .border-primary {
            border-color: @primaryColor !important;
        }
    </style>
</head>

<body class="authentication-bg position-relative">
    <div class="position-absolute start-0 end-0 start-0 bottom-0 w-100 h-100">
        <svg xmlns='http://www.w3.org/2000/svg' width='100%' height='100%' viewBox='0 0 800 800'>
            <g fill-opacity='0.22'>
                <circle style="fill: rgba(var(--ct-primary-rgb), 0.1);" cx='400' cy='400' r='600' />
                <circle style="fill: rgba(var(--ct-primary-rgb), 0.2);" cx='400' cy='400' r='500' />
                <circle style="fill: rgba(var(--ct-primary-rgb), 0.3);" cx='400' cy='400' r='300' />
                <circle style="fill: rgba(var(--ct-primary-rgb), 0.4);" cx='400' cy='400' r='200' />
                <circle style="fill: rgba(var(--ct-primary-rgb), 0.5);" cx='400' cy='400' r='100' />
            </g>
        </svg>
    </div>
    <div class="account-pages pt-2 pt-sm-5 pb-4 pb-sm-5 position-relative">
        <div class="container">
            <div class="row justify-content-center">
                <div class="col-xxl-4 col-lg-5">
                    <div class="card">

                        <!-- Logo -->
                        <div class="card-header py-4 text-center bg-primary">
                            <a asp-route="home">
                                <span>
                                    <img src="@logoUrl" alt="logo" height="22"
                                         style="height: 60px;border-radius: 5px;">
                                </span>
                            </a>
                        </div>

                        <div class="card-body p-4">

                            <form asp-route="admin-login-post" method="post">

                                <div class="mb-3">
                                    <label for="emailaddress" class="form-label">Tên đăng nhập</label>
                                    <input class="form-control" name="username" type="text" id="emailaddress"
                                           required="Vui lòng nhập" placeholder="Vui lòng nhập tên đăng nhập">
                                </div>

                                <div class="mb-3">
                                    <label for="password" class="form-label">Mật khẩu</label>
                                    <div class="input-group input-group-merge">
                                        <input type="password" id="password" name="password" class="form-control"
                                               placeholder="Vui lòng nhập mật khẩu">
                                        <div class="input-group-text" data-password="false">
                                            <span class="password-eye"></span>
                                        </div>
                                    </div>
                                </div>

                                @if (ViewBag.Success != null)
                                {
                                    if (ViewBag.Success == true)
                                    {
                                        <div class="form-group">
                                            <div class="form-input-group">
                                                <div class="alert alert-success">
                                                    @ViewBag.Message
                                                </div>
                                            </div>
                                        </div>
                                    }
                                    else
                                    {
                                        <div class="form-group">
                                            <div class="form-input-group">
                                                <div class="alert alert-danger">
                                                    @ViewBag.Message
                                                </div>
                                            </div>
                                        </div>
                                    }
                                }
                                <div class="mb-3 mb-0 text-center">
                                    <button class="btn btn-primary" type="submit"> Đăng nhập </button>
                                </div>

                            </form>
                        </div> <!-- end card-body -->
                    </div>
                    <!-- end card -->

                </div> <!-- end col -->
            </div>
            <!-- end row -->
        </div>
        <!-- end container -->
    </div>
    <!-- end page -->

    <footer class="footer footer-alt">
        2024 - <script>document.write(new Date().getFullYear())</script> © Bản quyền thuộc về Cao Gia Construction - Cung cấp bởi&nbsp;
        <a class="btn-link btn-info" target="_blank" href="https://hqsoftsolution.com/">HQSolutions</a>
    </footer>
    <!-- Vendor js -->
    <script src="~/Admin/assets/js/vendor.min.js"></script>

    <!-- App js -->
    <script src="~/Admin/assets/js/app.min.js"></script>

</body>

</html>
